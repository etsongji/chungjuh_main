<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¶©ì£¼ê³ ë“±í•™êµ ì—…ë¬´ ì‹œìŠ¤í…œ</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo">
                <img src="school-logo.png" alt="ì¶©ì£¼ê³ ë“±í•™êµ êµí‘œ" class="school-logo">
                <div class="logo-text">
                    <h1>ì¶©ì£¼ê³ ë“±í•™êµ</h1>
                    <span class="subtitle">ì—…ë¬´ ì‹œìŠ¤í…œ</span>
                </div>
            </div>
            <div class="year-badge">2025</div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="main-content-grid">
                <!-- ì™¼ìª½ 2 ë¹„ìœ¨: ì—…ë¬´ í¬í„¸ ì‚¬ì´ë“œë°” -->
                <div class="left-sidebar">
                    <div class="portal-banners">
                        <div class="portal-banner">
                            <a href="https://cbe.eduptl.kr" target="_blank" class="banner-link">
                                <div class="banner-icon">
                                    <i class="fas fa-briefcase"></i>
                                </div>
                                <div class="banner-content">
                                    <h3>ì—…ë¬´í¬í„¸</h3>
                                    <p>ì¶©ë¶êµìœ¡ì²­ ì—…ë¬´í¬í„¸</p>
                                </div>
                            </a>
                        </div>
                        
                        <div class="portal-banner">
                            <a href="https://edu.cbe.go.kr/main.do" target="_blank" class="banner-link">
                                <div class="banner-icon">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="banner-content">
                                    <h3>ì¶©ë¶êµìœ¡ì—°ìˆ˜í¬í„¸</h3>
                                    <p>êµì› ì—°ìˆ˜ ë° êµìœ¡</p>
                                </div>
                            </a>
                        </div>
                        
                        <div class="portal-banner">
                            <a href="https://www.cbe.go.kr/mpool/main.do" target="_blank" class="banner-link">
                                <div class="banner-icon">
                                    <i class="fas fa-school"></i>
                                </div>
                                <div class="banner-content">
                                    <h3>ì¶©ì²­ë¶ë„êµìœ¡ì²­</h3>
                                    <p>êµìœ¡ì²­ ê³µì‹ í™ˆí˜ì´ì§€</p>
                                </div>
                            </a>
                        </div>
                        
                        <div class="portal-banner">
                            <a href="https://school.cbe.go.kr/chungju-h/M01" target="_blank" class="banner-link">
                                <div class="banner-icon">
                                    <i class="fas fa-home"></i>
                                </div>
                                <div class="banner-content">
                                    <h3>ì¶©ì£¼ê³ ë“±í•™êµ</h3>
                                    <p>í•™êµ ê³µì‹ í™ˆí˜ì´ì§€</p>
                                </div>
                            </a>
                        </div>
                        
                        <div class="portal-banner">
                            <a href="https://evpn.cbe.go.kr" target="_blank" class="banner-link">
                                <div class="banner-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="banner-content">
                                    <h3>EVPN</h3>
                                    <p>ì¶©ë¶êµìœ¡ì²­ EVPN</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- ê°€ìš´ë° 6 ë¹„ìœ¨: ë©”ì¸ ì½˜í…ì¸  -->
                <div class="main-content">
                    <!-- í•™ì‚¬ì¼ì • ìº˜ë¦°ë” ì„¹ì…˜ -->
                    <div class="calendar-section calendar-card">
                        <div class="calendar-header">
                            <h2><i class="fas fa-calendar-alt"></i> ì¶©ì£¼ê³ ë“±í•™êµ í•™ì‚¬ì¼ì •</h2>
                        </div>
                        <div class="calendar-container">
                            <iframe src="https://calendar.google.com/calendar/embed?src=d6f9e02e8d247d64ea6a9133b08e664818a4d9c9dcfbc2248ba305e77e591646%40group.calendar.google.com&ctz=Asia%2FSeoul" 
                                    style="border: 0" 
                                    width="100%" 
                                    height="600" 
                                    frameborder="0" 
                                    scrolling="no">
                            </iframe>
                        </div>
                    </div>
                    
                    <div class="departments-grid">
                <!-- êµë¬´ê¸°íšë¶€ -->
                <div class="department-card">
                    <div class="department-header">
                        <i class="fas fa-clipboard-list"></i>
                        <h2>êµë¬´ê¸°íšë¶€</h2>
                        <span class="task-count">11ê°œ ì—…ë¬´</span>
                    </div>
                    <div class="department-content">
                        <ul class="task-list">
                            <li><a href="https://docs.google.com/spreadsheets/d/1l8MCxV0y-Yb6ODUKw720cp1lIZ3NCruQvRGEvNg6ERQ/edit" target="_blank" class="task-link"><i class="fas fa-calendar-week"></i>ì£¼ê°„ì—…ë¬´ê³„íš</a></li>
                            <li><a href="https://etsongji.github.io/document-validator-improved/" target="_blank" class="task-link"><i class="fas fa-file-alt"></i>ê³µë¬¸ì„œ ì´ˆì•ˆ ì ê²€</a></li>
                            <li><a href="https://docs.google.com/spreadsheets/u/0/d/1ipOuWwNkgJ-EHE1nKmLSu69bvIjGhULx3pUyT3z2CLA/edit" target="_blank" class="task-link"><i class="fas fa-chalkboard-teacher"></i>ì¤‘ê°„ê³ ì‚¬ ì—°ìˆ˜ì¼ì •</a></li>
                            <li><a href="https://drive.google.com/file/d/1ybpCnBsY_UduYRI-KhZY76Z2oJffpF-l/view" target="_blank" class="task-link"><i class="fas fa-calendar-alt"></i>í•™ì‚¬ì¼ì •(2025.4.9)</a></li>
                            <li><a href="https://drive.google.com/file/d/1BmYDE2rRPOac87px9Mi6utDtVmOwjNUE/view" target="_blank" class="task-link"><i class="fas fa-sitemap"></i>ê·¼ë¬´ìƒí™© ê²°ì¬ë¼ì¸</a></li>
                            <li><a href="https://drive.google.com/file/d/1nVP1w-gmaBilb1v4BnsmIQCz1aemCmj2/view" target="_blank" class="task-link"><i class="fas fa-book"></i>í•™êµìƒí™œê¸°ë¡ë¶€ ê¸°ì¬ìš”ë ¹</a></li>
                            <li><a href="https://notebooklm.google.com/notebook/5bb40190-af6b-488a-b4c8-4e313f12dc6a" target="_blank" class="task-link"><i class="fas fa-question-circle"></i>ì¸ì‚¬ ë§¤ë‰´ì–¼ Q&A</a></li>
                            <li><a href="https://etsongji.github.io/maternity-leave-calculator/" target="_blank" class="task-link"><i class="fas fa-calculator"></i>ì¶œì‚°íœ´ê°€ ê³„ì‚°ê¸°</a></li>
                            <li><a href="https://etsongji.github.io/chungbuk-teacher-calculator-2025/" target="_blank" class="task-link"><i class="fas fa-calculator"></i>ë§Œê¸° ê³„ì‚°ê¸°</a></li>
                            <li><a href="https://etsongji.github.io/weekly_board_cjh/schedule.html" target="_blank" class="task-link"><i class="fas fa-search"></i>ì£¼ê°„ í•™êµì¼ì • ì¡°íšŒ</a></li>
                            <li><a href="https://etsongji.github.io/weekly_board_cjh/" target="_blank" class="task-link"><i class="fas fa-tasks"></i>ë¶€ì„œë³„ ì£¼ê°„ì—…ë¬´</a></li>
                        </ul>
                    </div>
                </div>

                <!-- êµìœ¡ì—°êµ¬ë¶€ -->
                <div class="department-card">
                    <div class="department-header">
                        <i class="fas fa-microscope"></i>
                        <h2>êµìœ¡ì—°êµ¬ë¶€</h2>
                        <span class="task-count">1ê°œ ì—…ë¬´</span>
                    </div>
                    <div class="department-content">
                        <ul class="task-list">
                            <li><a href="https://docs.google.com/spreadsheets/d/1unEe3HYybxTSbOcMcWJjIz95KalBE7Hxd-HzpGHKHV0/edit" target="_blank" class="task-link"><i class="fas fa-comments"></i>ì§„ë¡œ ì§„í•™ ìƒë‹´ ìë£Œ(í•™ìƒì‘ì„±ìš©)</a></li>
                        </ul>
                    </div>
                </div>

                <!-- êµìœ¡ê³¼ì •ë¶€ -->
                <div class="department-card">
                    <div class="department-header">
                        <i class="fas fa-book-open"></i>
                        <h2>êµìœ¡ê³¼ì •ë¶€</h2>
                        <span class="task-count">6ê°œ ì—…ë¬´</span>
                    </div>
                    <div class="department-content">
                        <ul class="task-list">
                            <li><a href="https://docs.google.com/spreadsheets/d/11fUWPWYvso1oJbBlHr-aM7kCsLE5AiMKHfQXCLy_li4/edit?usp=sharing" target="_blank" class="task-link"><i class="fas fa-clock"></i>ìˆ˜ì—…ëŸ‰ìœ ì—°í™”</a></li>
                            <li><a href="https://docs.google.com/spreadsheets/d/1KRrprIta-zX6wYgC_OiK_xYnZL8U4kdtxPPKmjToAlA/edit?gid=0#gid=0" target="_blank" class="task-link"><i class="fas fa-table"></i>2026 í¸ì„±í‘œ</a></li>
                            <li><a href="#" class="task-link"><i class="fas fa-external-link-alt"></i>ì„ íƒê³¼ëª© ì•ˆë‚´ìë£Œ ëª¨ìŒ(ë…¸ì…˜)</a></li>
                            <li><a href="#" class="task-link"><i class="fas fa-chart-bar"></i>ì‹œìˆ˜ë°°ë‹¹í‘œ</a></li>
                            <li><a href="https://padlet.com/chungjugo/1-ku8uzfc2fbu1j5yp" target="_blank" class="task-link"><i class="fas fa-folder"></i>ì§„ë¡œ êµìœ¡ê³¼ì • ì„¤ê³„ í¬íŠ¸í´ë¦¬ì˜¤ 1í•™ë…„</a></li>
                            <li><a href="https://padlet.com/chungjugo/2-a5rwuerqa21wtoqd" target="_blank" class="task-link"><i class="fas fa-folder"></i>ì§„ë¡œ êµìœ¡ê³¼ì • ì„¤ê³„ í¬íŠ¸í´ë¦¬ì˜¤ 2í•™ë…„</a></li>
                        </ul>
                    </div>
                </div>

                <!-- ìê³µê³ ë°©ê³¼í›„ë¶€ -->
                <div class="department-card">
                    <div class="department-header">
                        <i class="fas fa-users"></i>
                        <h2>ìê³µê³ ë°©ê³¼í›„ë¶€</h2>
                        <span class="task-count">3ê°œ ì—…ë¬´</span>
                    </div>
                    <div class="department-content">
                        <ul class="task-list">
                            <li><a href="https://docs.google.com/spreadsheets/d/19uj9Dw8L_LpMrlaWLBrEIHKDF_g4bqOggy4Hn5BejdQ/edit?gid=1344074532#gid=1344074532" target="_blank" class="task-link"><i class="fas fa-clock"></i>ì°½ì²´ ì´ìˆ˜ì‹œê°„ ë° í™œë™ë‚ ì§œ</a></li>
                            <li><a href="https://docs.google.com/spreadsheets/d/1ZEbNIsvyDXuTxFkaGx_ZHft4eh9YJuCCrO_eFcuFWQo/edit?usp=sharing" target="_blank" class="task-link"><i class="fas fa-users"></i>ì°½ì²´ë™ì•„ë¦¬ êµ¬ì„±</a></li>
                            <li><a href="https://docs.google.com/spreadsheets/d/1blBpOHcaUo7hm-pgCC305zOOuw09hDMMci6PC5edKMY/edit" target="_blank" class="task-link"><i class="fas fa-heart"></i>1í•™ê¸° ë´‰ì‚¬í™œë™ ì¸ì •ì‹œê°„</a></li>
                        </ul>
                    </div>
                </div>

                <!-- 3í•™ë…„ë¶€ -->
                <div class="department-card">
                    <div class="department-header">
                        <i class="fas fa-user-graduate"></i>
                        <h2>3í•™ë…„ë¶€</h2>
                        <span class="task-count">1ê°œ ì—…ë¬´</span>
                    </div>
                    <div class="department-content">
                        <ul class="task-list">
                            <li><a href="https://docs.google.com/spreadsheets/d/12m74Y0FSzN9h4a3SLYL91WNHb4TqVvC1OVGvdxurRFA/edit?usp=sharing" target="_blank" class="task-link"><i class="fas fa-clock"></i>3í•™ë…„ 7êµì‹œ ìˆ˜ì—…ê³„íš</a></li>
                        </ul>
                    </div>
                </div>

                    </div>
                </div>
                
                <!-- ì˜¤ë¥¸ìª½ 2 ë¹„ìœ¨: ê¸‰ì‹ ì‚¬ì´ë“œë°” -->
                <div class="meal-sidebar">
                    <div class="meal-section">
                        <div class="meal-type-menu">
                            <button id="breakfastBtn" class="meal-type-btn" data-meal-type="1">
                                <i class="fas fa-sun"></i>
                                <span>ì¡°ì‹</span>
                            </button>
                            <button id="lunchBtn" class="meal-type-btn active" data-meal-type="2">
                                <i class="fas fa-utensils"></i>
                                <span>ì¤‘ì‹</span>
                            </button>
                            <button id="dinnerBtn" class="meal-type-btn" data-meal-type="3">
                                <i class="fas fa-moon"></i>
                                <span>ì„ì‹</span>
                            </button>
                        </div>
                        <div id="headerMealCard" class="meal-card">
                            <div class="meal-loading">ê¸‰ì‹ ì •ë³´ ë¡œë”© ì¤‘...</div>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 ì¶©ì£¼ê³ ë“±í•™êµ. All rights reserved. | Developed by songjieon</p>
        </div>
    </footer>

    <script>
        class HeaderMealCard {
            constructor() {
                this.apiKey = 'cc1b9c0a34804a628cc701f43a8398e1';
                this.schoolCode = '8000078';
                this.officeCode = 'M10';
                this.baseURL = 'https://open.neis.go.kr/hub/mealServiceDietInfo';
                this.currentDate = new Date();
                this.currentMealType = '2'; // ê¸°ë³¸ê°’: ì¤‘ì‹
                
                console.log('HeaderMealCard ì´ˆê¸°í™” (ê¸°ë³¸ ì¤‘ì‹):', {
                    currentDate: this.currentDate,
                    currentMealType: this.currentMealType,
                    mealName: this.getMealTypeName(this.currentMealType)
                });
                
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.loadMealData();
            }
            
            setupEventListeners() {
                // ì¡°ì‹ ë²„íŠ¼
                document.getElementById('breakfastBtn').addEventListener('click', () => {
                    this.selectMealType('1');
                });
                
                // ì¤‘ì‹ ë²„íŠ¼
                document.getElementById('lunchBtn').addEventListener('click', () => {
                    this.selectMealType('2');
                });
                
                // ì„ì‹ ë²„íŠ¼
                document.getElementById('dinnerBtn').addEventListener('click', () => {
                    this.selectMealType('3');
                });
            }
            
            selectMealType(mealType) {
                console.log('ğŸ½ï¸ ê¸‰ì‹ íƒ€ì… ì„ íƒ:', { ì„ íƒíƒ€ì…: mealType, ì´ì „íƒ€ì…: this.currentMealType });
                
                const oldMealType = this.currentMealType;
                this.currentMealType = mealType;
                
                // ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
                this.updateActiveButton();
                
                console.log('ğŸ”„ íƒ€ì… ë³€ê²½:', {
                    ì´ì „íƒ€ì…: oldMealType,
                    ìƒˆíƒ€ì…: this.currentMealType,
                    ì´ì „ì´ë¦„: this.getMealTypeName(oldMealType),
                    ìƒˆì´ë¦„: this.getMealTypeName(this.currentMealType)
                });
                
                this.loadMealData();
            }
            
            updateActiveButton() {
                // ëª¨ë“  ë²„íŠ¼ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
                document.querySelectorAll('.meal-type-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // í˜„ì¬ ì„ íƒëœ íƒ€ì…ì˜ ë²„íŠ¼ì— active í´ë˜ìŠ¤ ì¶”ê°€
                const activeButton = document.querySelector(`[data-meal-type="${this.currentMealType}"]`);
                if (activeButton) {
                    activeButton.classList.add('active');
                }
                
                console.log('ğŸ”˜ í™œì„± ë²„íŠ¼ ì—…ë°ì´íŠ¸:', { 
                    currentMealType: this.currentMealType,
                    activeButton: activeButton?.id
                });
            }
            
            
            formatDate(date) {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}${month}${day}`;
            }
            
            getDateString() {
                const month = this.currentDate.getMonth() + 1;
                const day = this.currentDate.getDate();
                return `${month}/${day}`;
            }
            
            async loadMealData() {
                const container = document.getElementById('headerMealCard');
                container.innerHTML = '<div class="meal-loading"><i class="fas fa-spinner fa-spin"></i> ê¸‰ì‹ ì •ë³´ ë¡œë”© ì¤‘...</div>';
                
                const dateStr = this.formatDate(this.currentDate);
                console.log('ê¸‰ì‹ ë°ì´í„° ë¡œë”©:', {
                    date: dateStr,
                    mealType: this.currentMealType,
                    currentDate: this.currentDate
                });
                
                try {
                    const data = await this.fetchMealData();
                    console.log('âœ… API ì„±ê³µ - ì‹¤ì œ ê¸‰ì‹ ë°ì´í„° ì‚¬ìš©:', data);
                    this.displayMealCard(data);
                } catch (error) {
                    console.log('âŒ API í˜¸ì¶œ ì‹¤íŒ¨:', error.message);
                    console.log('ğŸ”„ ìƒ˜í”Œ ë°ì´í„°ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤');
                    this.showSampleMeal();
                }
            }
            
            async fetchMealData() {
                const dateStr = this.formatDate(this.currentDate);
                const targetUrl = `${this.baseURL}?KEY=${this.apiKey}&Type=json&pIndex=1&pSize=100&ATPT_OFCDC_SC_CODE=${this.officeCode}&SD_SCHUL_CODE=${this.schoolCode}&MLSV_YMD=${dateStr}`;
                
                console.log('ğŸŒ API ìš”ì²­ URL:', targetUrl);
                
                // 1. ì§ì ‘ ìš”ì²­ ë¨¼ì € ì‹œë„
                try {
                    console.log('1ï¸âƒ£ ì§ì ‘ ìš”ì²­ ì‹œë„...');
                    const response = await fetch(targetUrl, {
                        method: 'GET',
                        headers: {
                            'Accept': 'application/json',
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log('âœ… ì§ì ‘ ìš”ì²­ ì„±ê³µ!', data);
                        if (data.mealServiceDietInfo) {
                            return data;
                        }
                    }
                    console.log('ì§ì ‘ ìš”ì²­ ì‘ë‹µ ìƒíƒœ:', response.status, response.statusText);
                } catch (error) {
                    console.log('ì§ì ‘ ìš”ì²­ ì‹¤íŒ¨:', error.message);
                }
                
                // 2. CORS Proxy ì‹œë„
                try {
                    console.log('2ï¸âƒ£ CORS Proxy ì‹œë„...');
                    const corsProxyUrl = `https://cors-anywhere.herokuapp.com/${targetUrl}`;
                    const response = await fetch(corsProxyUrl);
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log('âœ… CORS Proxy ì„±ê³µ!', data);
                        if (data.mealServiceDietInfo) {
                            return data;
                        }
                    }
                } catch (error) {
                    console.log('CORS Proxy ì‹¤íŒ¨:', error.message);
                }
                
                // 3. AllOrigins í”„ë¡ì‹œ ì‹œë„
                try {
                    console.log('3ï¸âƒ£ AllOrigins í”„ë¡ì‹œ ì‹œë„...');
                    const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(targetUrl)}`;
                    const response = await fetch(proxyUrl);
                    
                    if (response.ok) {
                        const proxyData = await response.json();
                        console.log('AllOrigins ì‘ë‹µ:', proxyData);
                        if (proxyData.contents) {
                            const data = JSON.parse(proxyData.contents);
                            console.log('âœ… AllOrigins ì„±ê³µ!', data);
                            if (data.mealServiceDietInfo) {
                                return data;
                            }
                        }
                    }
                } catch (error) {
                    console.log('AllOrigins í”„ë¡ì‹œ ì‹¤íŒ¨:', error.message);
                }
                
                // 4. Proxy API ì‹œë„ 
                try {
                    console.log('4ï¸âƒ£ Proxy API ì‹œë„...');
                    const proxyUrl = `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(targetUrl)}`;
                    const response = await fetch(proxyUrl);
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log('âœ… Proxy API ì„±ê³µ!', data);
                        if (data.mealServiceDietInfo) {
                            return data;
                        }
                    }
                } catch (error) {
                    console.log('Proxy API ì‹¤íŒ¨:', error.message);
                }
                
                throw new Error('ëª¨ë“  API í˜¸ì¶œ ë°©ë²•ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
            }
            
            displayMealCard(data) {
                const container = document.getElementById('headerMealCard');
                
                console.log('displayMealCard í˜¸ì¶œ:', {
                    data: data,
                    hasMealInfo: !!data.mealServiceDietInfo,
                    currentMealType: this.currentMealType
                });
                
                if (!data.mealServiceDietInfo) {
                    console.log('ê¸‰ì‹ ì •ë³´ ì—†ìŒ - API ì‘ë‹µì— mealServiceDietInfoê°€ ì—†ìŒ');
                    this.showNoMealMessage();
                    return;
                }
                
                const meals = data.mealServiceDietInfo[1].row;
                console.log('ì „ì²´ ê¸‰ì‹ ëª©ë¡:', meals);
                console.log('ì°¾ê³  ìˆëŠ” ê¸‰ì‹ íƒ€ì…:', this.currentMealType);
                
                // APIì—ì„œ í•œê¸€ ì´ë¦„ìœ¼ë¡œ ì˜¤ëŠ” ê²½ìš° ì²˜ë¦¬
                const targetMealCode = this.currentMealType;
                const targetMealName = this.getMealTypeName(targetMealCode);
                
                console.log('ê¸‰ì‹ ì°¾ê¸°:', {
                    ì°¾ëŠ”ì½”ë“œ: targetMealCode,
                    ì°¾ëŠ”ì´ë¦„: targetMealName,
                    APIë°ì´í„°: meals.map(m => ({ ì½”ë“œ: m.MMEAL_SC_NM, íƒ€ì…: typeof m.MMEAL_SC_NM }))
                });
                
                const targetMeal = meals.find(meal => {
                    const mealCode = String(meal.MMEAL_SC_NM);
                    // ìˆ«ì ì½”ë“œë¡œ ë¹„êµ
                    if (mealCode === targetMealCode) return true;
                    // í•œê¸€ ì´ë¦„ìœ¼ë¡œ ë¹„êµ
                    if (mealCode === targetMealName) return true;
                    // ì—­ë³€í™˜í•´ì„œ ë¹„êµ
                    const convertedCode = this.convertMealNameToCode(mealCode);
                    if (convertedCode === targetMealCode) return true;
                    return false;
                });
                
                if (!targetMeal) {
                    console.log('ğŸš« í•´ë‹¹ ê¸‰ì‹ íƒ€ì…ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                    console.log('ì‚¬ìš© ê°€ëŠ¥í•œ ê¸‰ì‹ íƒ€ì…ë“¤:', meals.map(m => m.MMEAL_SC_NM));
                    console.log('ê° ê¸‰ì‹ì˜ ì„¸ë¶€ì •ë³´:', meals.map(m => ({
                        type: m.MMEAL_SC_NM,
                        name: this.getMealTypeName(m.MMEAL_SC_NM),
                        raw: m
                    })));
                    
                    // ëŒ€ì•ˆ: ì‚¬ìš© ê°€ëŠ¥í•œ ê¸‰ì‹ì—ì„œ ìš”ì²­ëœ íƒ€ì… ì°¾ê¸°
                    console.log('ì›í•˜ëŠ” ê¸‰ì‹ íƒ€ì…ì´ ì—†ì–´ì„œ ëŒ€ì•ˆ ì°¾ëŠ” ì¤‘...');
                    console.log('ì°¾ëŠ” íƒ€ì…:', this.currentMealType, 'ì°¾ëŠ” ì´ë¦„:', this.getMealTypeName(this.currentMealType));
                    
                    // í˜„ì¬ ì°¾ê³  ìˆëŠ” íƒ€ì…ì— ë§ëŠ” ê¸‰ì‹ì´ ìˆëŠ”ì§€ ë‹¤ì‹œ í•œë²ˆ í™•ì¸
                    const wantedMealName = this.getMealTypeName(this.currentMealType);
                    const matchingMeal = meals.find(meal => 
                        String(meal.MMEAL_SC_NM) === wantedMealName || 
                        String(meal.MMEAL_SC_NM) === this.currentMealType
                    );
                    
                    if (matchingMeal) {
                        console.log('âœ… ë§¤ì¹­ë˜ëŠ” ê¸‰ì‹ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤!', matchingMeal);
                        this.displayFoundMeal(matchingMeal);
                        return;
                    }
                    
                    // âš ï¸ ì¤‘ìš”í•œ ë³€ê²½: ë‹¤ë¥¸ ê¸‰ì‹ íƒ€ì…ì´ ìˆì–´ë„ ì‚¬ìš©í•˜ì§€ ì•Šê³  "ì—†ìŒ" ë©”ì‹œì§€ í‘œì‹œ
                    console.log('âŒ ìš”ì²­í•œ ê¸‰ì‹ íƒ€ì…ì´ ì—†ìŠµë‹ˆë‹¤. ìƒ˜í”Œ ë°ì´í„°ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.');
                    this.showSampleMeal();
                    return;
                }
                
                console.log('ì •í™•í•œ ê¸‰ì‹ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤:', targetMeal);
                this.displayFoundMeal(targetMeal);
            }
            
            displayFoundMeal(targetMeal) {
                const container = document.getElementById('headerMealCard');
                
                // currentMealTypeì„ ìš°ì„  ì‚¬ìš© (ì‚¬ìš©ìê°€ ì„ íƒí•œ íƒ€ì…)
                const displayMealType = this.getMealTypeName(this.currentMealType);
                const cardClass = this.getMealCardClass(this.currentMealType);
                
                const menuItems = targetMeal.DDISH_NM
                    .replace(/<br\/>/g, '\n')
                    .replace(/<[^>]*>/g, '')
                    .split('\n')
                    .filter(item => item.trim());
                
                const dateStr = this.getDateString();
                
                console.log('ğŸ½ï¸ ê¸‰ì‹ í‘œì‹œ ìƒì„¸ ë””ë²„ê¹…:', {
                    currentMealType: this.currentMealType,
                    currentMealTypeíƒ€ì…: typeof this.currentMealType,
                    displayMealType: displayMealType,
                    cardClass: cardClass,
                    menuCount: menuItems.length,
                    actualMealData: targetMeal.MMEAL_SC_NM,
                    getMealTypeName_rawê²°ê³¼: this.getMealTypeName(this.currentMealType),
                    getMealCardClass_rawê²°ê³¼: this.getMealCardClass(this.currentMealType)
                });
                
                // ìˆ˜ë™ìœ¼ë¡œ í•œë²ˆ ë” í™•ì¸
                console.log('ğŸ” ìˆ˜ë™ í™•ì¸:', {
                    '1ì€': this.getMealTypeName('1'),
                    '2ëŠ”': this.getMealTypeName('2'), 
                    '3ì€': this.getMealTypeName('3'),
                    'currentMealTypeìœ¼ë¡œ_ì§ì ‘í˜¸ì¶œ': this.getMealTypeName(this.currentMealType)
                });
                
                container.innerHTML = `
                    <div class="header-meal-content ${cardClass}">
                        <div class="meal-header-title">
                            <i class="fas fa-utensils"></i>
                            <span>${dateStr} ${displayMealType}</span>
                        </div>
                        <div class="meal-menu-list">
                            ${menuItems.slice(0, 6).map(item => `<div class="menu-item">${item}</div>`).join('')}
                            ${menuItems.length > 6 ? `<div class="menu-more">+${menuItems.length - 6}ê°œ ë”</div>` : ''}
                        </div>
                    </div>
                `;
            }
            
            showSampleMeal() {
                const container = document.getElementById('headerMealCard');
                const mealType = this.currentMealType;
                const dateStr = this.getDateString();
                
                console.log('ğŸ½ï¸ ìƒ˜í”Œ ë°ì´í„° í‘œì‹œ:', {
                    currentMealType: mealType,
                    mealName: this.getMealTypeName(mealType),
                    dateStr: dateStr
                });
                
                let cardClass, mealName, menuItems;
                
                if (mealType === '1') { // ì¡°ì‹
                    cardClass = 'breakfast-card';
                    mealName = 'ì¡°ì‹';
                    menuItems = `
                        <div class="menu-item">í† ìŠ¤íŠ¸</div>
                        <div class="menu-item">ê³„ë€í›„ë¼ì´</div>
                        <div class="menu-item">ë² ì´ì»¨</div>
                        <div class="menu-item">ìƒëŸ¬ë“œ</div>
                        <div class="menu-item">ìš°ìœ </div>
                        <div class="menu-item">ì˜¤ë Œì§€ì£¼ìŠ¤</div>
                    `;
                } else if (mealType === '2') { // ì¤‘ì‹
                    cardClass = 'lunch-card';
                    mealName = 'ì¤‘ì‹';
                    menuItems = `
                        <div class="menu-item">ì¹œí™˜ê²½ìŒ€ë°¥</div>
                        <div class="menu-item">ë§‘ì€ë¯¸ì—­êµ­</div>
                        <div class="menu-item">ëˆê¹ŒìŠ¤</div>
                        <div class="menu-item">ê¹ë‘ê¸°</div>
                        <div class="menu-item">ìš°ìœ </div>
                        <div class="menu-item">ì‚¬ê³¼</div>
                    `;
                } else { // ì„ì‹
                    cardClass = 'dinner-card';
                    mealName = 'ì„ì‹';
                    menuItems = `
                        <div class="menu-item">ì¹œí™˜ê²½í˜„ë¯¸ë°¥</div>
                        <div class="menu-item">ê¹€ì¹˜ì°Œê°œ</div>
                        <div class="menu-item">ì œìœ¡ë³¶ìŒ</div>
                        <div class="menu-item">ì½©ë‚˜ë¬¼ë¬´ì¹¨</div>
                        <div class="menu-item">ë°°ì¶”ê¹€ì¹˜</div>
                        <div class="menu-item">ìš”êµ¬ë¥´íŠ¸</div>
                    `;
                }
                
                container.innerHTML = `
                    <div class="header-meal-content ${cardClass}">
                        <div class="meal-header-title">
                            <i class="fas fa-utensils"></i>
                            <span>${dateStr} ${mealName}</span>
                        </div>
                        <div class="meal-menu-list">
                            ${menuItems}
                        </div>
                    </div>
                `;
            }
            
            showNoMealMessage() {
                const container = document.getElementById('headerMealCard');
                const dateStr = this.getDateString();
                const mealType = this.getMealTypeName(this.currentMealType);
                
                console.log('ğŸš« ê¸‰ì‹ ì •ë³´ ì—†ìŒ í‘œì‹œ:', {
                    currentMealType: this.currentMealType,
                    displayMealType: mealType
                });
                
                container.innerHTML = `
                    <div class="header-meal-content no-meal">
                        <div class="meal-header-title">
                            <i class="fas fa-calendar-times"></i>
                            <span>${dateStr} ${mealType}</span>
                        </div>
                        <div class="no-meal-text">
                            <p>ê¸‰ì‹ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                        </div>
                    </div>
                `;
            }
            
            getMealTypeName(code) {
                const mealTypes = {
                    '1': 'ì¡°ì‹',
                    '2': 'ì¤‘ì‹', 
                    '3': 'ì„ì‹',
                    1: 'ì¡°ì‹',
                    2: 'ì¤‘ì‹',
                    3: 'ì„ì‹'
                };
                console.log('getMealTypeName í˜¸ì¶œ:', { code: code, type: typeof code, result: mealTypes[code] });
                return mealTypes[code] || mealTypes[String(code)] || 'ì¤‘ì‹';
            }
            
            convertMealNameToCode(name) {
                const nameToCode = {
                    'ì¡°ì‹': '1',
                    'ì¤‘ì‹': '2',
                    'ì„ì‹': '3'
                };
                return nameToCode[name] || name;
            }
            
            getMealTime(code) {
                const mealTimes = {
                    '1': 'ì•„ì¹¨',
                    '2': 'ì ì‹¬',
                    '3': 'ì €ë…'
                };
                return mealTimes[code] || 'ì‹ì‚¬';
            }
            
            getMealCardClass(code) {
                const cardClasses = {
                    '1': 'breakfast-card',
                    '2': 'lunch-card',
                    '3': 'dinner-card',
                    1: 'breakfast-card',
                    2: 'lunch-card',
                    3: 'dinner-card'
                };
                return cardClasses[code] || cardClasses[String(code)] || 'lunch-card';
            }
            
        }

        // ì „ì—­ ë³€ìˆ˜ë¡œ ì„¤ì •
        let headerMealCard;

        document.addEventListener('DOMContentLoaded', function() {
            // ê¸°ì¡´ ì´ˆê¸°í™” í•¨ìˆ˜ë“¤
            initializeAnimations();
            addSearchFunctionality();
            addCardInteractions();
            trackTaskClicks();
            
            // í—¤ë” ê¸‰ì‹ ì¹´ë“œ ì´ˆê¸°í™”
            headerMealCard = new HeaderMealCard();
        });

        // ê¸°ì¡´ í•¨ìˆ˜ë“¤
        function initializeAnimations() {
            const cards = document.querySelectorAll('.department-card');
            
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    card.style.transition = 'all 0.6s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        }

        function addSearchFunctionality() {
            const header = document.querySelector('.header .container');
            const searchContainer = document.createElement('div');
            searchContainer.className = 'search-container';
            searchContainer.innerHTML = `
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="ì—…ë¬´ ê²€ìƒ‰..." />
                    <i class="fas fa-search"></i>
                </div>
            `;
            
            header.insertBefore(searchContainer, header.lastElementChild);
            
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                filterTasks(searchTerm);
            });
        }

        function filterTasks(searchTerm) {
            const taskLinks = document.querySelectorAll('.task-link');
            const departmentCards = document.querySelectorAll('.department-card');
            
            taskLinks.forEach(link => {
                const taskText = link.textContent.toLowerCase();
                
                if (taskText.includes(searchTerm) || searchTerm === '') {
                    link.style.display = 'flex';
                } else {
                    link.style.display = 'none';
                }
            });
            
            departmentCards.forEach(card => {
                const visibleTasks = card.querySelectorAll('.task-link[style*="flex"]');
                const allTasks = card.querySelectorAll('.task-link');
                
                if (searchTerm === '' || visibleTasks.length > 0) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
                
                if (searchTerm === '') {
                    allTasks.forEach(task => {
                        task.style.display = 'flex';
                    });
                }
            });
        }

        function addCardInteractions() {
            const departmentCards = document.querySelectorAll('.department-card');
            
            departmentCards.forEach(card => {
                const header = card.querySelector('.department-header');
                const content = card.querySelector('.department-content');
                
                header.style.cursor = 'pointer';
                
                header.addEventListener('click', function() {
                    const isExpanded = content.style.display !== 'none';
                    
                    if (isExpanded) {
                        content.style.display = 'none';
                        card.classList.add('collapsed');
                    } else {
                        content.style.display = 'block';
                        card.classList.remove('collapsed');
                    }
                });
            });
        }

        function trackTaskClicks() {
            const taskLinks = document.querySelectorAll('.task-link');
            
            taskLinks.forEach(link => {
                if (link.getAttribute('href') !== '#') {
                    link.addEventListener('click', function(e) {
                        const taskName = this.textContent.trim();
                        
                        this.style.transform = 'scale(0.98)';
                        setTimeout(() => {
                            this.style.transform = '';
                        }, 150);
                        
                        this.setAttribute('target', '_blank');
                        console.log(`${taskName} ë§í¬ë¡œ ì´ë™`);
                    });
                } else {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        
                        const taskName = this.textContent.trim();
                        const departmentName = this.closest('.department-card').querySelector('h2').textContent;
                        
                        this.style.transform = 'scale(0.98)';
                        setTimeout(() => {
                            this.style.transform = '';
                        }, 150);
                        
                        console.log(`${departmentName} - ${taskName} í´ë¦­ë¨`);
                        showNotification(`${taskName} í˜ì´ì§€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.`);
                    });
                }
            });
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
                z-index: 1000;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // ê²€ìƒ‰ ê¸°ëŠ¥ ìŠ¤íƒ€ì¼
        const searchStyles = `
            .search-container {
                flex: 1;
                max-width: 400px;
                margin: 0 20px;
            }
            
            .search-box {
                position: relative;
                width: 100%;
            }
            
            .search-box input {
                width: 100%;
                padding: 12px 20px 12px 45px;
                border: 2px solid #e9ecef;
                border-radius: 25px;
                font-size: 1rem;
                outline: none;
                transition: all 0.3s ease;
                background: rgba(255, 255, 255, 0.9);
            }
            
            .search-box input:focus {
                border-color: #667eea;
                box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
                background: white;
            }
            
            .search-box i {
                position: absolute;
                left: 15px;
                top: 50%;
                transform: translateY(-50%);
                color: #6c757d;
            }
            
            .department-card.collapsed {
                opacity: 0.7;
            }
            
            @media (max-width: 768px) {
                .search-container {
                    margin: 10px 0;
                    max-width: 100%;
                }
                
                .header .container {
                    flex-direction: column;
                }
            }
        `;

        const searchStyle = document.createElement('style');
        searchStyle.textContent = searchStyles;
        document.head.appendChild(searchStyle);
    </script>
</body>
</html>